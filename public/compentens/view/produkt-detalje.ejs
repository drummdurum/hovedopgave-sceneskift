<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> - SceneSkift</title>
  <link rel="icon" href="/compentens/image/logo rundt.png">
  <link rel="stylesheet" href="/css/output.css">
</head>
<body class="flex flex-col min-h-screen" style="background-color: var(--color-light); font-family: var(--font-body);">
  
  <!-- Header -->
  <header class="sticky top-0 z-50" style="background-color: transparent; z-index: 50;">
    <%- include('../header/header') %>
  </header>
    
  <!-- Hero sektion med baggrundsbillede -->
  <section class="relative min-h-[50vh] md:min-h-[40vh] flex flex-col" style="background-image: url('/compentens/image/forside.webp'); background-size: cover; background-position: center; background-repeat: no-repeat; margin-top: -100px; margin-bottom: 20px;">
    <div class="absolute inset-0" style="background-color: rgba(0, 0, 0, 0.5); z-index: 0;"></div>
    <div class="flex flex-col items-center justify-center w-full px-4 md:px-6 flex-grow relative" style="z-index: 1;">
      <div class="text-center" style="padding: 60px 16px;">
        <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-2" style="font-family: var(--font-heading); color: var(--color-light); text-shadow: 2px 2px 8px rgba(0,0,0,0.8);">
          <span id="produktNavnHero">IndlÃ¦ser...</span>
        </h1>
        <p class="text-base md:text-lg" style="color: var(--color-light); opacity: 0.9;">
          <a href="/rekvisitter" class="hover:underline">â† Tilbage til alle rekvisitter</a>
          <% if (typeof user !== 'undefined' && user && user.rolle === 'admin') { %>
            <span style="margin: 0 8px;">|</span>
            <a href="/admin/hovedlager" class="hover:underline">â† Tilbage til hovedlager</a>
          <% } %>
        </p>
      </div>
    </div>
  </section>

  <!-- Main content -->
  <main class="flex-grow container-max px-4 md:px-6 py-6 md:py-12">
    
    <!-- Loading state -->
    <div id="loadingState" class="text-center py-16">
      <div class="animate-pulse">
        <div class="w-16 h-16 mx-auto mb-4 rounded-full" style="background-color: var(--color-secondary);"></div>
        <p style="color: var(--color-dark);">IndlÃ¦ser produkt...</p>
      </div>
    </div>

    <!-- Error state -->
    <div id="errorState" class="hidden text-center py-16">
      <div class="bg-white rounded-2xl shadow-xl p-10 max-w-lg mx-auto">
        <span class="text-6xl mb-4 block">ğŸ˜•</span>
        <h3 class="text-2xl mb-4" style="font-family: var(--font-heading); color: var(--color-primary);">Produkt ikke fundet</h3>
        <p class="mb-6" style="color: var(--color-dark); opacity: 0.8;">
          Det produkt du leder efter findes ikke eller er blevet fjernet.
        </p>
        <a href="/rekvisitter" class="btn-primary">Se alle rekvisitter</a>
      </div>
    </div>

    <!-- Product content -->
    <div id="produktContent" class="hidden">
      <div class="max-w-6xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-stretch">
          
          <!-- Venstre kolonne: Billeder -->
          <div class="bg-white rounded-2xl shadow-xl p-4 md:p-6 flex flex-col">
            <div class="gallery-main" id="galleryMain">
              <img id="mainImage" src="" alt="Produkt billede">
              <button class="gallery-nav prev" onclick="prevImage()">â€¹</button>
              <button class="gallery-nav next" onclick="nextImage()">â€º</button>
            </div>
            <div class="gallery-thumbnails" id="galleryThumbnails">
              <!-- Thumbnails genereres via JavaScript -->
            </div>
            <!-- Spacer til at pushe knappen ned -->
            <div class="flex-grow"></div>
            <!-- TilfÃ¸j til kurv knap -->
              <div class="flex flex-col sm:flex-row gap-3" style="padding-top: 15px;">
                <button id="tilfoejKurvBtn" onclick="tilfoejTilKurv()" class="btn-primary flex-1 py-3 flex items-center justify-center gap-2" style="padding: 10px 10px;">
                  ğŸ›’ TilfÃ¸j
                </button>
                <button id="fjernKurvBtn" onclick="fjernFraKurv()" class="btn-secondary flex-1 py-3 hidden flex items-center justify-center gap-2" style="padding: 10px 10px;">
                  âœ• Fjern
                </button>
              </div>
          </div>
          
          <!-- HÃ¸jre kolonne: Info -->
          <div class="flex flex-col">
            <!-- Titel og status badges -->
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6 flex-grow flex flex-col">
              <div class="flex flex-wrap gap-2 mb-4" id="kategorierContainer">
                <!-- Kategorier genereres via JavaScript -->
              </div>
              
              <h2 id="produktNavn" class="text-2xl md:text-3xl font-bold mb-4" style="font-family: var(--font-heading); color: var(--color-primary);"></h2>
              
              <div class="flex flex-wrap gap-2 mb-6" id="statusBadges">
                <!-- Status badges genereres via JavaScript -->
              </div>
              
              <div class="mb-6">
                <h4 class="text-lg font-semibold mb-2" style="color: var(--color-dark);">Beskrivelse</h4>
                <p id="produktBeskrivelse" class="leading-relaxed" style="color: var(--color-dark); opacity: 0.85;"></p>
              </div>
              
              <!-- Spacer til at pushe placeringsboks ned -->
              <div class="flex-grow"></div>
              
              <!-- Placering boks -->
              <div id="placeringBoks" class="p-4 rounded-xl mt-auto" style="background-color: #f3f4f6;">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸ“</span>
                  <div>
                    <p class="text-sm" style="color: var(--color-dark); opacity: 0.7;">Placering</p>
                    <p id="produktPlacering" class="font-semibold" style="color: var(--color-dark);">IndlÃ¦ser...</p>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Ejer information -->
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
              <h4 class="text-lg font-semibold mb-4" style="color: var(--color-dark);">Udbydes af</h4>
              <div class="flex items-center gap-4" id="ejerInfo">
                <!-- Ejer info genereres via JavaScript -->
              </div>
            </div>
          </div>
        </div>
        
        <!-- Reservationer sektion -->
        <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mt-8" id="reservationerSection">
          <h3 class="text-xl md:text-2xl font-bold mb-6" style="font-family: var(--font-heading); color: var(--color-primary);">
            ğŸ“… Reservationer
          </h3>
          <div id="reservationerListe">
            <!-- Reservationer genereres via JavaScript -->
          </div>
        </div>

        <!-- Admin sektion - kun synlig for admin -->
        <% if (typeof user !== 'undefined' && user && user.rolle === 'admin') { %>
        <div class="bg-red-50 border-2 border-red-200 rounded-2xl shadow-xl p-6 md:p-8 mt-8">
          <div class="flex items-start gap-4">
            <span class="text-3xl">âš ï¸</span>
            <div class="flex-grow">
              <h3 class="text-xl font-bold mb-2" style="color: #dc2626;">
                Admin kontrol
              </h3>
              <p class="mb-4" style="color: #991b1b; opacity: 0.9;">
                Som administrator kan du slette dette produkt. Denne handling kan ikke fortrydes.
              </p>
              <button 
                onclick="sletProduktSomAdmin()" 
                class="px-6 py-3 rounded-lg font-semibold transition hover:bg-red-700"
                style="background-color: #dc2626; color: white;">
                ğŸ—‘ï¸ Slet produkt
              </button>
            </div>
          </div>
        </div>
        <% } %>
      </div>
    </div>

  </main>

  <!-- Footer -->
  <%- include('../footer/footer') %>

  <script>
    const produktId = JSON.parse('<%- JSON.stringify(produktId) %>');
  </script>
  <script src="/compentens/js/kurv-global.js"></script>
  <script src="/compentens/js/produkt-detalje.js"></script>
</body>
</html>
